(function(){class Barcode{static data_to_row_patterns(data){throw Error("static data_to_row_patterns() not implemented")}static get QUIET_ZONE(){throw Error("static get QUIET_ZONE() not implemented")}static get QUIET_ZONE_X(){return this.QUIET_ZONE}static get QUIET_ZONE_Y(){return this.QUIET_ZONE}static get PRESCALE_RATIO_X(){}static get PRESCALE_RATIO_Y(){}static create(...args){return new this(...args)}constructor(data){this.data=data,this.row_patterns=this.constructor.data_to_row_patterns(data),this.raw_width=this.row_patterns[0].length,this.raw_height=this.row_patterns.length}}class Barcode_2D extends Barcode{}var element_name,Barcode_Class,qrcode=function(){var qrcode=function(typeNumber,errorCorrectionLevel){var _typeNumber=typeNumber,_errorCorrectionLevel=QRErrorCorrectionLevel[errorCorrectionLevel],_modules=null,_moduleCount=0,_dataCache=null,_dataList=[],_this={},makeImpl=function(test,maskPattern){_modules=function(moduleCount){for(var modules=new Array(moduleCount),row=0;row<moduleCount;row+=1){modules[row]=new Array(moduleCount);for(var col=0;col<moduleCount;col+=1)modules[row][col]=null}return modules}(_moduleCount=4*_typeNumber+17),setupPositionProbePattern(0,0),setupPositionProbePattern(_moduleCount-7,0),setupPositionProbePattern(0,_moduleCount-7),setupPositionAdjustPattern(),setupTimingPattern(),setupTypeInfo(test,maskPattern),_typeNumber>=7&&setupTypeNumber(test),null==_dataCache&&(_dataCache=createData(_typeNumber,_errorCorrectionLevel,_dataList)),mapData(_dataCache,maskPattern)},setupPositionProbePattern=function(row,col){for(var r=-1;r<=7;r+=1)if(!(row+r<=-1||_moduleCount<=row+r))for(var c=-1;c<=7;c+=1)col+c<=-1||_moduleCount<=col+c||(_modules[row+r][col+c]=0<=r&&r<=6&&(0==c||6==c)||0<=c&&c<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=c&&c<=4)},setupTimingPattern=function(){for(var r=8;r<_moduleCount-8;r+=1)null==_modules[r][6]&&(_modules[r][6]=r%2==0);for(var c=8;c<_moduleCount-8;c+=1)null==_modules[6][c]&&(_modules[6][c]=c%2==0)},setupPositionAdjustPattern=function(){for(var pos=QRUtil.getPatternPosition(_typeNumber),i=0;i<pos.length;i+=1)for(var j=0;j<pos.length;j+=1){var row=pos[i],col=pos[j];if(null==_modules[row][col])for(var r=-2;r<=2;r+=1)for(var c=-2;c<=2;c+=1)_modules[row+r][col+c]=-2==r||2==r||-2==c||2==c||0==r&&0==c}},setupTypeNumber=function(test){for(var bits=QRUtil.getBCHTypeNumber(_typeNumber),i=0;i<18;i+=1){var mod=!test&&1==(bits>>i&1);_modules[Math.floor(i/3)][i%3+_moduleCount-8-3]=mod}for(i=0;i<18;i+=1){mod=!test&&1==(bits>>i&1);_modules[i%3+_moduleCount-8-3][Math.floor(i/3)]=mod}},setupTypeInfo=function(test,maskPattern){for(var data=_errorCorrectionLevel<<3|maskPattern,bits=QRUtil.getBCHTypeInfo(data),i=0;i<15;i+=1){var mod=!test&&1==(bits>>i&1);i<6?_modules[i][8]=mod:i<8?_modules[i+1][8]=mod:_modules[_moduleCount-15+i][8]=mod}for(i=0;i<15;i+=1){mod=!test&&1==(bits>>i&1);i<8?_modules[8][_moduleCount-i-1]=mod:i<9?_modules[8][15-i-1+1]=mod:_modules[8][15-i-1]=mod}_modules[_moduleCount-8][8]=!test},mapData=function(data,maskPattern){for(var inc=-1,row=_moduleCount-1,bitIndex=7,byteIndex=0,maskFunc=QRUtil.getMaskFunction(maskPattern),col=_moduleCount-1;col>0;col-=2)for(6==col&&(col-=1);;){for(var c=0;c<2;c+=1)if(null==_modules[row][col-c]){var dark=!1;byteIndex<data.length&&(dark=1==(data[byteIndex]>>>bitIndex&1)),maskFunc(row,col-c)&&(dark=!dark),_modules[row][col-c]=dark,-1==(bitIndex-=1)&&(byteIndex+=1,bitIndex=7)}if((row+=inc)<0||_moduleCount<=row){row-=inc,inc=-inc;break}}},createData=function(typeNumber,errorCorrectionLevel,dataList){for(var rsBlocks=QRRSBlock.getRSBlocks(typeNumber,errorCorrectionLevel),buffer=qrBitBuffer(),i=0;i<dataList.length;i+=1){var data=dataList[i];buffer.put(data.getMode(),4),buffer.put(data.getLength(),QRUtil.getLengthInBits(data.getMode(),typeNumber)),data.write(buffer)}var totalDataCount=0;for(i=0;i<rsBlocks.length;i+=1)totalDataCount+=rsBlocks[i].dataCount;if(buffer.getLengthInBits()>8*totalDataCount)throw"code length overflow. ("+buffer.getLengthInBits()+">"+8*totalDataCount+")";for(buffer.getLengthInBits()+4<=8*totalDataCount&&buffer.put(0,4);buffer.getLengthInBits()%8!=0;)buffer.putBit(!1);for(;!(buffer.getLengthInBits()>=8*totalDataCount||(buffer.put(236,8),buffer.getLengthInBits()>=8*totalDataCount));)buffer.put(17,8);return function(buffer,rsBlocks){for(var offset=0,maxDcCount=0,maxEcCount=0,dcdata=new Array(rsBlocks.length),ecdata=new Array(rsBlocks.length),r=0;r<rsBlocks.length;r+=1){var dcCount=rsBlocks[r].dataCount,ecCount=rsBlocks[r].totalCount-dcCount;maxDcCount=Math.max(maxDcCount,dcCount),maxEcCount=Math.max(maxEcCount,ecCount),dcdata[r]=new Array(dcCount);for(var i=0;i<dcdata[r].length;i+=1)dcdata[r][i]=255&buffer.getBuffer()[i+offset];offset+=dcCount;var rsPoly=QRUtil.getErrorCorrectPolynomial(ecCount),modPoly=qrPolynomial(dcdata[r],rsPoly.getLength()-1).mod(rsPoly);for(ecdata[r]=new Array(rsPoly.getLength()-1),i=0;i<ecdata[r].length;i+=1){var modIndex=i+modPoly.getLength()-ecdata[r].length;ecdata[r][i]=modIndex>=0?modPoly.getAt(modIndex):0}}var totalCodeCount=0;for(i=0;i<rsBlocks.length;i+=1)totalCodeCount+=rsBlocks[i].totalCount;var data=new Array(totalCodeCount),index=0;for(i=0;i<maxDcCount;i+=1)for(r=0;r<rsBlocks.length;r+=1)i<dcdata[r].length&&(data[index]=dcdata[r][i],index+=1);for(i=0;i<maxEcCount;i+=1)for(r=0;r<rsBlocks.length;r+=1)i<ecdata[r].length&&(data[index]=ecdata[r][i],index+=1);return data}(buffer,rsBlocks)};return _this.addData=function(data,mode){var newData=null;switch(mode=mode||"Byte"){case"Numeric":newData=qrNumber(data);break;case"Alphanumeric":newData=qrAlphaNum(data);break;case"Byte":newData=qr8BitByte(data);break;case"Kanji":newData=qrKanji(data);break;default:throw"mode:"+mode}_dataList.push(newData),_dataCache=null},_this.isDark=function(row,col){if(row<0||_moduleCount<=row||col<0||_moduleCount<=col)throw row+","+col;return _modules[row][col]},_this.getModuleCount=function(){return _moduleCount},_this.make=function(){if(_typeNumber<1){for(var typeNumber=1;typeNumber<40;typeNumber++){for(var rsBlocks=QRRSBlock.getRSBlocks(typeNumber,_errorCorrectionLevel),buffer=qrBitBuffer(),i=0;i<_dataList.length;i++){var data=_dataList[i];buffer.put(data.getMode(),4),buffer.put(data.getLength(),QRUtil.getLengthInBits(data.getMode(),typeNumber)),data.write(buffer)}var totalDataCount=0;for(i=0;i<rsBlocks.length;i++)totalDataCount+=rsBlocks[i].dataCount;if(buffer.getLengthInBits()<=8*totalDataCount)break}_typeNumber=typeNumber}makeImpl(!1,function(){for(var minLostPoint=0,pattern=0,i=0;i<8;i+=1){makeImpl(!0,i);var lostPoint=QRUtil.getLostPoint(_this);(0==i||minLostPoint>lostPoint)&&(minLostPoint=lostPoint,pattern=i)}return pattern}())},_this};qrcode.stringToBytes=(qrcode.stringToBytesFuncs={default:function(s){for(var bytes=[],i=0;i<s.length;i+=1){var c=s.charCodeAt(i);bytes.push(255&c)}return bytes}}).default,qrcode.createStringToBytes=function(unicodeData,numChars){var unicodeMap=function(){for(var bin=base64DecodeInputStream(unicodeData),read=function(){var b=bin.read();if(-1==b)throw"eof";return b},count=0,unicodeMap={};;){var b0=bin.read();if(-1==b0)break;var b1=read(),v=read()<<8|read();unicodeMap[String.fromCharCode(b0<<8|b1)]=v,count+=1}if(count!=numChars)throw count+" != "+numChars;return unicodeMap}(),unknownChar="?".charCodeAt(0);return function(s){for(var bytes=[],i=0;i<s.length;i+=1){var c=s.charCodeAt(i);if(c<128)bytes.push(c);else{var b=unicodeMap[s.charAt(i)];"number"==typeof b?(255&b)==b?bytes.push(b):(bytes.push(b>>>8),bytes.push(255&b)):bytes.push(unknownChar)}}return bytes}};var PATTERN_POSITION_TABLE,_this,getBCHDigit,QRMode_MODE_NUMBER=1,QRMode_MODE_ALPHA_NUM=2,QRMode_MODE__BIT_BYTE=4,QRMode_MODE_KANJI=8,QRErrorCorrectionLevel={L:1,M:0,Q:3,H:2},QRMaskPattern_PATTERN_=0,QRMaskPattern_PATTERN_$0=1,QRMaskPattern_PATTERN_$1=2,QRMaskPattern_PATTERN_$2=3,QRMaskPattern_PATTERN_$3=4,QRMaskPattern_PATTERN_$4=5,QRMaskPattern_PATTERN_$5=6,QRMaskPattern_PATTERN_$6=7,QRUtil=(PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],getBCHDigit=function(data){for(var digit=0;0!=data;)digit+=1,data>>>=1;return digit},(_this={}).getBCHTypeInfo=function(data){for(var d=data<<10;getBCHDigit(d)-getBCHDigit(1335)>=0;)d^=1335<<getBCHDigit(d)-getBCHDigit(1335);return 21522^(data<<10|d)},_this.getBCHTypeNumber=function(data){for(var d=data<<12;getBCHDigit(d)-getBCHDigit(7973)>=0;)d^=7973<<getBCHDigit(d)-getBCHDigit(7973);return data<<12|d},_this.getPatternPosition=function(typeNumber){return PATTERN_POSITION_TABLE[typeNumber-1]},_this.getMaskFunction=function(maskPattern){switch(maskPattern){case QRMaskPattern_PATTERN_:return function(i,j){return(i+j)%2==0};case QRMaskPattern_PATTERN_$0:return function(i,j){return i%2==0};case QRMaskPattern_PATTERN_$1:return function(i,j){return j%3==0};case QRMaskPattern_PATTERN_$2:return function(i,j){return(i+j)%3==0};case QRMaskPattern_PATTERN_$3:return function(i,j){return(Math.floor(i/2)+Math.floor(j/3))%2==0};case QRMaskPattern_PATTERN_$4:return function(i,j){return i*j%2+i*j%3==0};case QRMaskPattern_PATTERN_$5:return function(i,j){return(i*j%2+i*j%3)%2==0};case QRMaskPattern_PATTERN_$6:return function(i,j){return(i*j%3+(i+j)%2)%2==0};default:throw"bad maskPattern:"+maskPattern}},_this.getErrorCorrectPolynomial=function(errorCorrectLength){for(var a=qrPolynomial([1],0),i=0;i<errorCorrectLength;i+=1)a=a.multiply(qrPolynomial([1,QRMath.gexp(i)],0));return a},_this.getLengthInBits=function(mode,type){if(1<=type&&type<10)switch(mode){case QRMode_MODE_NUMBER:return 10;case QRMode_MODE_ALPHA_NUM:return 9;case QRMode_MODE__BIT_BYTE:case QRMode_MODE_KANJI:return 8;default:throw"mode:"+mode}else if(type<27)switch(mode){case QRMode_MODE_NUMBER:return 12;case QRMode_MODE_ALPHA_NUM:return 11;case QRMode_MODE__BIT_BYTE:return 16;case QRMode_MODE_KANJI:return 10;default:throw"mode:"+mode}else{if(!(type<41))throw"type:"+type;switch(mode){case QRMode_MODE_NUMBER:return 14;case QRMode_MODE_ALPHA_NUM:return 13;case QRMode_MODE__BIT_BYTE:return 16;case QRMode_MODE_KANJI:return 12;default:throw"mode:"+mode}}},_this.getLostPoint=function(qrcode){for(var moduleCount=qrcode.getModuleCount(),lostPoint=0,row=0;row<moduleCount;row+=1)for(var col=0;col<moduleCount;col+=1){for(var sameCount=0,dark=qrcode.isDark(row,col),r=-1;r<=1;r+=1)if(!(row+r<0||moduleCount<=row+r))for(var c=-1;c<=1;c+=1)col+c<0||moduleCount<=col+c||0==r&&0==c||dark==qrcode.isDark(row+r,col+c)&&(sameCount+=1);sameCount>5&&(lostPoint+=3+sameCount-5)}for(row=0;row<moduleCount-1;row+=1)for(col=0;col<moduleCount-1;col+=1){var count=0;qrcode.isDark(row,col)&&(count+=1),qrcode.isDark(row+1,col)&&(count+=1),qrcode.isDark(row,col+1)&&(count+=1),qrcode.isDark(row+1,col+1)&&(count+=1),0!=count&&4!=count||(lostPoint+=3)}for(row=0;row<moduleCount;row+=1)for(col=0;col<moduleCount-6;col+=1)qrcode.isDark(row,col)&&!qrcode.isDark(row,col+1)&&qrcode.isDark(row,col+2)&&qrcode.isDark(row,col+3)&&qrcode.isDark(row,col+4)&&!qrcode.isDark(row,col+5)&&qrcode.isDark(row,col+6)&&(lostPoint+=40);for(col=0;col<moduleCount;col+=1)for(row=0;row<moduleCount-6;row+=1)qrcode.isDark(row,col)&&!qrcode.isDark(row+1,col)&&qrcode.isDark(row+2,col)&&qrcode.isDark(row+3,col)&&qrcode.isDark(row+4,col)&&!qrcode.isDark(row+5,col)&&qrcode.isDark(row+6,col)&&(lostPoint+=40);var darkCount=0;for(col=0;col<moduleCount;col+=1)for(row=0;row<moduleCount;row+=1)qrcode.isDark(row,col)&&(darkCount+=1);return lostPoint+=Math.abs(100*darkCount/moduleCount/moduleCount-50)/5*10},_this),QRMath=function(){for(var EXP_TABLE=new Array(256),LOG_TABLE=new Array(256),i=0;i<8;i+=1)EXP_TABLE[i]=1<<i;for(i=8;i<256;i+=1)EXP_TABLE[i]=EXP_TABLE[i-4]^EXP_TABLE[i-5]^EXP_TABLE[i-6]^EXP_TABLE[i-8];for(i=0;i<255;i+=1)LOG_TABLE[EXP_TABLE[i]]=i;var _this={glog:function(n){if(n<1)throw"glog("+n+")";return LOG_TABLE[n]},gexp:function(n){for(;n<0;)n+=255;for(;n>=256;)n-=255;return EXP_TABLE[n]}};return _this}();function qrPolynomial(num,shift){if(void 0===num.length)throw num.length+"/"+shift;var _num=function(){for(var offset=0;offset<num.length&&0==num[offset];)offset+=1;for(var _num=new Array(num.length-offset+shift),i=0;i<num.length-offset;i+=1)_num[i]=num[i+offset];return _num}(),_this={getAt:function(index){return _num[index]},getLength:function(){return _num.length},multiply:function(e){for(var num=new Array(_this.getLength()+e.getLength()-1),i=0;i<_this.getLength();i+=1)for(var j=0;j<e.getLength();j+=1)num[i+j]^=QRMath.gexp(QRMath.glog(_this.getAt(i))+QRMath.glog(e.getAt(j)));return qrPolynomial(num,0)},mod:function(e){if(_this.getLength()-e.getLength()<0)return _this;for(var ratio=QRMath.glog(_this.getAt(0))-QRMath.glog(e.getAt(0)),num=new Array(_this.getLength()),i=0;i<_this.getLength();i+=1)num[i]=_this.getAt(i);for(i=0;i<e.getLength();i+=1)num[i]^=QRMath.gexp(QRMath.glog(e.getAt(i))+ratio);return qrPolynomial(num,0).mod(e)}};return _this}var QRRSBlock=function(){var RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],qrRSBlock=function(totalCount,dataCount){var _this={};return _this.totalCount=totalCount,_this.dataCount=dataCount,_this},_this={};return _this.getRSBlocks=function(typeNumber,errorCorrectionLevel){var rsBlock=function(typeNumber,errorCorrectionLevel){switch(errorCorrectionLevel){case QRErrorCorrectionLevel.L:return RS_BLOCK_TABLE[4*(typeNumber-1)+0];case QRErrorCorrectionLevel.M:return RS_BLOCK_TABLE[4*(typeNumber-1)+1];case QRErrorCorrectionLevel.Q:return RS_BLOCK_TABLE[4*(typeNumber-1)+2];case QRErrorCorrectionLevel.H:return RS_BLOCK_TABLE[4*(typeNumber-1)+3];default:return}}(typeNumber,errorCorrectionLevel);if(void 0===rsBlock)throw"bad rs block @ typeNumber:"+typeNumber+"/errorCorrectionLevel:"+errorCorrectionLevel;for(var length=rsBlock.length/3,list=[],i=0;i<length;i+=1)for(var count=rsBlock[3*i+0],totalCount=rsBlock[3*i+1],dataCount=rsBlock[3*i+2],j=0;j<count;j+=1)list.push(qrRSBlock(totalCount,dataCount));return list},_this}(),qrBitBuffer=function(){var _buffer=[],_length=0,_this={getBuffer:function(){return _buffer},getAt:function(index){var bufIndex=Math.floor(index/8);return 1==(_buffer[bufIndex]>>>7-index%8&1)},put:function(num,length){for(var i=0;i<length;i+=1)_this.putBit(1==(num>>>length-i-1&1))},getLengthInBits:function(){return _length},putBit:function(bit){var bufIndex=Math.floor(_length/8);_buffer.length<=bufIndex&&_buffer.push(0),bit&&(_buffer[bufIndex]|=128>>>_length%8),_length+=1}};return _this},qrNumber=function(data){var _mode=QRMode_MODE_NUMBER,_data=data,_this={getMode:function(){return _mode},getLength:function(buffer){return _data.length},write:function(buffer){for(var data=_data,i=0;i+2<data.length;)buffer.put(strToNum(data.substring(i,i+3)),10),i+=3;i<data.length&&(data.length-i==1?buffer.put(strToNum(data.substring(i,i+1)),4):data.length-i==2&&buffer.put(strToNum(data.substring(i,i+2)),7))}},strToNum=function(s){for(var num=0,i=0;i<s.length;i+=1)num=10*num+chatToNum(s.charAt(i));return num},chatToNum=function(c){if("0"<=c&&c<="9")return c.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+c};return _this},qrAlphaNum=function(data){var _mode=QRMode_MODE_ALPHA_NUM,_data=data,_this={getMode:function(){return _mode},getLength:function(buffer){return _data.length},write:function(buffer){for(var s=_data,i=0;i+1<s.length;)buffer.put(45*getCode(s.charAt(i))+getCode(s.charAt(i+1)),11),i+=2;i<s.length&&buffer.put(getCode(s.charAt(i)),6)}},getCode=function(c){if("0"<=c&&c<="9")return c.charCodeAt(0)-"0".charCodeAt(0);if("A"<=c&&c<="Z")return c.charCodeAt(0)-"A".charCodeAt(0)+10;switch(c){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+c}};return _this},qr8BitByte=function(data){var _mode=QRMode_MODE__BIT_BYTE,_bytes=qrcode.stringToBytes(data),_this={getMode:function(){return _mode},getLength:function(buffer){return _bytes.length},write:function(buffer){for(var i=0;i<_bytes.length;i+=1)buffer.put(_bytes[i],8)}};return _this},qrKanji=function(data){var _mode=QRMode_MODE_KANJI,stringToBytes=qrcode.stringToBytesFuncs.SJIS;if(!stringToBytes)throw"sjis not supported.";!function(c,code){var test=stringToBytes("友");if(2!=test.length||38726!=(test[0]<<8|test[1]))throw"sjis not supported."}();var _bytes=stringToBytes(data),_this={getMode:function(){return _mode},getLength:function(buffer){return~~(_bytes.length/2)},write:function(buffer){for(var data=_bytes,i=0;i+1<data.length;){var c=(255&data[i])<<8|255&data[i+1];if(33088<=c&&c<=40956)c-=33088;else{if(!(57408<=c&&c<=60351))throw"illegal char at "+(i+1)+"/"+c;c-=49472}c=192*(c>>>8&255)+(255&c),buffer.put(c,13),i+=2}if(i<data.length)throw"illegal char at "+(i+1)}};return _this};return qrcode}();function value_with_default(...values){for(value of values)if(null!==value&&void 0!==value&&value==value)return value}qrcode.stringToBytesFuncs["UTF-8"]=function(s){return function(str){for(var utf8=[],i=0;i<str.length;i++){var charcode=str.charCodeAt(i);charcode<128?utf8.push(charcode):charcode<2048?utf8.push(192|charcode>>6,128|63&charcode):charcode<55296||charcode>=57344?utf8.push(224|charcode>>12,128|charcode>>6&63,128|63&charcode):(i++,charcode=65536+((1023&charcode)<<10|1023&str.charCodeAt(i)),utf8.push(240|charcode>>18,128|charcode>>12&63,128|charcode>>6&63,128|63&charcode))}return utf8}(s)};class Barcode_Renderer{static render_with_values(row_patterns,options,scale_x,scale_y,quiet_zone_x,quiet_zone_y,unscaled_width,unscaled_height,scaled_width,scaled_height){throw Error("static render_with_values() not implemented")}static render(barcode,options){options=value_with_default(options,{});let barcode_class=barcode.constructor,quiet_zone=options.quiet_zone,quiet_zone_x=value_with_default(options.quiet_zone_x,quiet_zone,barcode_class.QUIET_ZONE_X),quiet_zone_y=value_with_default(options.quiet_zone_y,quiet_zone,barcode_class.QUIET_ZONE_Y),unscaled_width=barcode.raw_width+2*quiet_zone_x,unscaled_height=barcode.raw_height+2*quiet_zone_y,afterscale=value_with_default(options.scale,1),afterscale_x=value_with_default(options.scale_x,afterscale),afterscale_y=value_with_default(options.scale_y,afterscale),prescale_ratio_x=value_with_default(options.prescale_ratio_x,barcode_class.PRESCALE_RATIO_X),prescale_ratio_y=value_with_default(options.prescale_ratio_y,barcode_class.PRESCALE_RATIO_Y),prescale_x=value_with_default(options.prescale_x,prescale_ratio_x*unscaled_height,1),prescale_y=value_with_default(options.prescale_y,prescale_ratio_y*unscaled_width,1),scale_x=Math.round(prescale_x*afterscale_x),scale_y=Math.round(prescale_y*afterscale_y),scaled_width=unscaled_width*scale_x,scaled_height=unscaled_height*scale_y;return this.render_with_values(barcode.row_patterns,options,scale_x,scale_y,quiet_zone_x,quiet_zone_y,unscaled_width,unscaled_height,scaled_width,scaled_height)}}class SVG_Barcode_Renderer extends Barcode_Renderer{static create_element(name,attributes,...childs){throw Error("static create_element() not implemented")}static pattern_to_path_data(pattern){let last_character,bar_start_index,path_data_fragments=[],offset_index=0;for(let current_index=0;current_index<=pattern.length;current_index++){let current_character=pattern[current_index];current_character!==last_character&&("1"===last_character?(offset_index!==bar_start_index&&(path_data_fragments.push(`m${bar_start_index-offset_index},0`),offset_index=bar_start_index),path_data_fragments.push(`v1h${current_index-bar_start_index}v-1z`)):bar_start_index=current_index,last_character=current_character)}return path_data_fragments.join("")}static row_pattern_to_path_data(row_pattern,row_index){return`M0,${row_index}${this.pattern_to_path_data(row_pattern)}`}static row_patterns_to_path_d(row_patterns){return row_patterns.map(this.row_pattern_to_path_data,this).join("")}static render_with_values(row_patterns,options,scale_x,scale_y,quiet_zone_x,quiet_zone_y,unscaled_width,unscaled_height,scaled_width,scaled_height){return this.create_element("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${unscaled_width} ${unscaled_height}`,width:scaled_width,height:scaled_height,preserveAspectRatio:"none"},this.create_element("rect",{width:unscaled_width,height:unscaled_height,fill:"#fff"}),this.create_element("path",{transform:`translate(${quiet_zone_x},${quiet_zone_y})`,d:this.row_patterns_to_path_d(row_patterns)}))}}class SVG_Element_Barcode_Renderer extends SVG_Barcode_Renderer{static create_element(name,attributes,...childs){return function(name_at_namespace,attributes,...childs){let[name,namespace]=name_at_namespace.split("@"),element=namespace?document.createElementNS(namespace,name):document.createElement(name);for(let key in attributes)element.setAttribute(key,attributes[key]);for(let child of childs)element.appendChild(child);return element}(`${name}@http://www.w3.org/2000/svg`,attributes,...childs)}}element_name="qr-code",Barcode_Class=class extends Barcode_2D{static data_to_row_patterns(data){let qr=function(data,error_correction_level,type){for(mode of(error_correction_level=value_with_default(error_correction_level,"L"),type=value_with_default(type,0),["Numeric","Alphanumeric","Byte","Kanji"]))try{let qr=qrcode(type,error_correction_level);return qr.addData(data,mode),qr.make(),qr}catch(error){}throw Error("Unable to encode data")}(data),array=Array(qr.getModuleCount()).fill(0);return array.map(function(a,y){return array.map(function(b,x){return qr.isDark(y,x)?"1":"0"}).join("")})}static get QUIET_ZONE(){return 4}},customElements.define(element_name,class extends HTMLElement{static get observedAttributes(){return["data","quiet_zone","quiet_zone_x","quiet_zone_y","scale","scale_x","scale_y","prescale_ratio_x","prescale_ratio_y","prescale_x","prescale_y"]}constructor(){super(),this.shadow_root=this.attachShadow({mode:"open"})}get_attribute(key){return this.hasAttribute(key)?this.getAttribute(key):null}render(){for(;this.shadow_root.hasChildNodes();)this.shadow_root.removeChild(this.shadow_root.lastChild);let data=this.get_attribute("data");null!==data&&this.shadow_root.appendChild(SVG_Element_Barcode_Renderer.render(Barcode_Class.create(data),{quiet_zone:this.get_attribute("quiet_zone"),quiet_zone_x:this.get_attribute("quiet_zone_x"),quiet_zone_y:this.get_attribute("quiet_zone_y"),scale:this.get_attribute("scale"),scale_x:this.get_attribute("scale_x"),scale_y:this.get_attribute("scale_y"),prescale_ratio_x:this.get_attribute("prescale_ratio_x"),prescale_ratio_y:this.get_attribute("prescale_ratio_y"),prescale_x:this.get_attribute("prescale_x"),prescale_y:this.get_attribute("prescale_y")}))}attributeChangedCallback(attribute_name,old_value,new_value){new_value!==old_value&&this.render()}})}).call(this);
